pipeline {
    agent any
    environment {
    
    	filename = '/export/home/webadmin/.jenkins/jobs/mk245-test-folder/jobs/jasper-report-job/workspace/ExtensionCode/PickListReport/TMW/PickListReport.zip'
	}
    parameters {
    	gitParameter branchFilter: 'origin/(.*)', defaultValue: 'test2-jenki', name: 'BRANCH', type: 'PT_BRANCH'
  	}
    options {
        skipStagesAfterUnstable()
    	    }
	    
    stages {
        stage('Build') {
            steps {
                echo "Building from branch ${params.BRANCH}"
		git branch: "${params.BRANCH}",
                credentialsId: 'test',
                url: 'https://github.com/bimsoft/Employment_proj.git'
		echo "${WORKSPACE}"
		sh 'ls -lrt'
		
		script {
			echo "parameter name...................${params.folder}"
		
			if (params.folder == "Parent") {
				echo " Parent selected"
			} else {
				echo " ${params.folder} selected"
			}
		} 
		
   		   
            }
        }
	
        stage('creating zip') {
            steps {
                echo 'Testing'
                //zip zipFile: 'todo-api.zip', dir:'todo-api' 
		sh 'zip todo-api.zip todo-api'
		sh "ls -lrt \${WORKSPACE}"  
            }
        }
        stage('Deploy') {
            steps {
                //sh "curl -v https://tssls.omni.manh.com/oauth/token?grant_type=password&username=admin@TMW.com&password=Password1!")
		//sh('curl -b session -X POST http://deployhub.openmakesoftware.com/API/UserProfile?user=admin')
		//def response = httpRequest "https://tssls.omni.manh.com/oauth/token?grant_type=password&username=admin@TMW.com&password=Password1!"
		//println('Status: '+response.status)
		//println('Response: '+response.content)
		echo 'Deploy'
            }
        }
    }
    post {
    	always {
		echo "Wow.... Deleting Zip file from \${WORKSPACE}"
		sh "rm -rf \${WORKSPACE}/todo-api.zip"
		}
	}
}
